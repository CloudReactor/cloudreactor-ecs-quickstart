{# Ignore this comment below, you are viewing the Dockefile template, 
  "Dockerfile.j2". The comment goes in the generated Dockerfile. #}
# Do not edit this file directly, it is generated from deploy/Dockerfile.j2
FROM python:3.8.2

LABEL maintainer="jeff@cloudreactor.io"

{# For the web task example only. #}
{# If you are not deploying the web task you can comment this out. #}
EXPOSE 7070

WORKDIR /usr/src/app

RUN pip install --upgrade pip==20.0.2

COPY ./requirements.txt .

# install dependencies
RUN pip install -r requirements.txt

# Run as non-root user for better security
RUN useradd --create-home appuser
WORKDIR /home/appuser

COPY deploy/files/proc_wrapper_1.2.2.py proc_wrapper.py

# copy secrets
COPY build/{{ env }}/.env .env

COPY src/*.py ./

CMD python proc_wrapper.py $TASK_COMMAND
